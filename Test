
# Generate the HTML email content with updated CSS
$html = @"
   <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f7f7f7; /* Set the background color to a light gray */
            margin: 0;
            padding: 0;
        }

        h1 {
            text-align: left; /* Align the title to the left */
            font-size: 24px; /* Set the font size to 24 */
            color: #1A73E8; /* Set the title color to blue */
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
            background-color: #ffffff; /* Set the background color to white */
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%; /* Set the table width to 100% */
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            padding: 10px;
            text-align: left;
            vertical-align: middle;
        }

        th {
            background-color: #1A73E8; /* Set the column names style to blue background */
            font-size: 16px; /* Set the font size to 16 */
            font-weight: bold;
            color: #ffffff; /* Set the column names style to white font color */
        }

        td {
            font-size: 14px;
            color: #333333; /* Set text color to dark gray */
            border: 1px solid #dddddd; /* Add borders to table cells */
        }

        .success {
            color: #4CAF50;
            font-weight: bold;
        }

        .failed {
            color: #f44336;
            font-weight: bold;
        }

        .unstable {
            color: #ff9800;
            font-weight: bold;
        }

        /* Add styles for Saas table */
        .saas-table {
            width: 100%; /* Set the table width to 100% */
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        /* Add styles for Saas table headers */
        .saas-table th {
            background-color: #1A73E8; /* Set the column names style to blue background */
            font-size: 16px; /* Set the font size to 16 */
            font-weight: bold;
            color: #ffffff; /* Set the column names style to white font color */
        }

        /* Add styles for Saas table cells */
        .saas-table td {
            padding: 10px;
            text-align: left;
            vertical-align: middle;
            border: 1px solid #dddddd; /* Add borders to table cells */
        }

        /* Add styles for success, failed, and unstable cells */
        .success {
            background-color: #DFF2DF; /* Set a light green background for success cells */
            color: #4CAF50;
            font-weight: bold;
        }

        .failed {
            background-color: #FADBD8; /* Set a light red background for failed cells */
            color: #f44336;
            font-weight: bold;
        }

        .unstable {
            background-color: #FEEFB3; /* Set a light yellow background for unstable cells */
            color: #ff9800;
            font-weight: bold;
        }
    </style>

<div class="container">
    <h1 style="color: #1A73E8;">Environment Tests Overall Summary</h1>
    <table>
        <tr>
            <th class="header">Environment</th>
            <th class="header">Success Rate</th>
        </tr>
        $tableRows
    </table>
    
    <!-- Add Saas clients table -->
    <h1 style="color: #1A73E8;">Saas Clients Environment Tests Summary</h1>
    <table class="saas-table">
        <tr>
            <th class="header">Environment</th>
            <th class="header">Success Rate</th>
        </tr>
        $saasTableRows
    </table>
</div>
"@

$html | Set-Content -Path "email_body.html"
