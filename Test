jobs:
  - job: StopAppPools
    displayName: 'Stop App Pool'
    pool:
      vmImage: 'windows-latest'
    steps:
      - ${{ if eq(parameters['App Pools'], '27xService') }}:
        - ${{ if eq(parameters['Servers'], 'All UAT Servers') }}:
          - task: PowerShell@2
            displayName: 'Stop 27x App Pool on All UAT Servers'
            inputs:
              targetType: 'remoteMachine'
              actionType: 'Inline'
              scriptType: 'Inline'
              inlineScript: |
                Stop-WebAppPool -Name '27xService' -ComputerName 'UATAPPAPP01'
                Stop-WebAppPool -Name '27xService' -ComputerName 'UATAPPAPP02'
          - ${{ elseif eq(parameters['Servers'], 'UATAPPAPP01.chicago.local') }}:
            - task: PowerShell@2
              displayName: 'Stop 27x App Pool on UATAPPAPP01'
              inputs:
                targetType: 'remoteMachine'
                actionType: 'Inline'
                scriptType: 'Inline'
                inlineScript: |
                  Stop-WebAppPool -Name '27xService' -ComputerName 'UATAPPAPP01'
          - ${{ elseif eq(parameters['Servers'], 'UATAPPAPP02.chicago.local') }}:
            - task: PowerShell@2
              displayName: 'Stop 27x App Pool on UATAPPAPP02'
              inputs:
                targetType: 'remoteMachine'
                actionType: 'Inline'
                scriptType: 'Inline'
                inlineScript: |
                  Stop-WebAppPool -Name '27xService' -ComputerName 'UATAPPAPP02'
        ${{ endif }}
      ${{ endif }}
